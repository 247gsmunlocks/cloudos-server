<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>CloudOS</title>
	<link rel="stylesheet" href="css/app.css">
	<script src="js/app.js"></script>
	<script src="js/apps/cloudos-app.js"></script>
	<script src="localize?js/local/strings.js"></script>
	<meta name="viewport" content="width=device-width" />
</head>
<body>

<script type="text/x-handlebars">
	<section class="app-bar">
		<nav class="top-bar" data-topbar role="navigation">
			<ul class="title-area">
				<li class="name">
					<h1>
						<a class="brand" href="#">{{t app.title}}</a>
					</h1>
				</li>
				<li class="toggle-topbar menu-icon">
					<a href="#">
						<span></span>
					</a>
				</li>
			</ul>
			{{#if cloudos_account}}
				<section class="top-bar-section">
					<ul class="right">
						<li class="has-dropdown">
							<a href="#">
								<span class="icon-question-circle"><span class="caption-for-icon show-for-small">Help</span></span>
								<span class="show-for-xxlarge-up">Help</span>
							</a>
							<ul class="dropdown">
								<li><a href="#">{{t menu.help.online}}</a></li>
								<li><a href="#">{{t menu.help.news}}</a></li>
								<li><a href="#">{{t menu.help.status}}</a></li>
								<li class="divider"></li>
								<li><a href="#">{{t menu.help.ticket}}</a></li>
							</ul>
						</li>
						<li class="has-dropdown">
							<a href="#" data-dropdown="settings-submenu" data-options="align:left">
								<span class="icon-gear"><span class="caption-for-icon show-for-small">Settings</span></span>
								<span class="show-for-xxlarge-up">Settings</span>
							</a>
							<ul class="dropdown">
								<li><label>{{t menu.cloudstead.label}}</label></li>
								{{#if cloudos_account.admin}}
									<li><a href="/admin.html#/accounts">{{t menu.accounts}}</a></li>
									<li><a href="/admin.html#/email">{{t menu.emaildom}}</a></li>
									<li><a href="/admin.html#/security">{{t menu.securitycert}}</a></li>
								{{/if}}
								<li><a href="#">{{t menu.defaultapps}}</a></li>
								<li><a href="/admin.html#/appstore">{{t menu.appstore}}</a></li>
								<li class="divider"></li>
								<li><label>{{t menu.cloudstead.other_label}}</label></li>
								<li><a href="#">{{t menu.cloudstead.confluence}}</a></li>
								<li><a href="#">{{t menu.cloudstead.jira}}</a></li>
								<li><a href="#">{{t menu.cloudstead.phabricator}}</a></li>
							</ul>
						</li>
						<li class="has-dropdown">
							<a href="#" data-dropdown="user-submenu" data-options="align:left">
								<span class="icon-user"><span class="caption-for-icon show-for-small">User</span></span>
								<span class="show-for-xxlarge-up">User</span>
							</a>
							<ul class="dropdown">
								<li>{{#link-to 'profile'}}{{t menu.profile}}{{/link-to}}</li>
								<li>{{#link-to 'settings'}}{{t menu.settings}}{{/link-to}}</li>
								<li class="divider"></li>
								<li>{{#link-to 'logout'}}{{t sections.logout}}{{/link-to}}</li>
							</ul>
						</li>
					</ul>
					<ul class="nav-apps">
						{{#each cloudos_account.availableApps}}
							<li>
								<a {{action 'select_app' this.name}}>
									<span {{bind-attr class=this.icon_name}} data-tooltip aria-haspopup="true" class="has-tip" title="{{app-name name}}">
										<span class="show-for-small">{{app-name name}}</span>
									</span>
									<span class="show-for-xxlarge-up">{{app-name name}}</span>
								</a>
							</li>
						{{/each}}
					</ul>
				</section>
				<section class="top-bar-section show-for-medium-up right">
					<div class="row">
						<div class="large-12 columns">
							<div class="row collapse">
								<div class="small-10 columns">
									<input type="text" placeholder="">
								</div>
								<div class="small-2 columns">
									<a href="#" class="button tiny" style="top:0px;"><span class="icon-search"></span> <span class="show-for-xxlarge-up">Search</span></a>
								</div>
							</div>
						</div>
					</div>
				</section>
			{{/if}}
		</nav>
	</section>

	{{outlet}}
	{{outlet modal}}
</script>

<script type="text/x-handlebars" id="login">
	<section class="deck">
		<div class="row">
			<div class="medium-6 large-5 small-12 medium-centered columns">
				<form {{action 'doLogin' on="submit"}}>
					<fieldset class="wrap-set small-12">
						<legend>{{t sections.login}}</legend>
						<div class="field-container">
							<label for="text">{{t forms.login.username}}</label>
							{{#if requestMessages.error.username}}
								{{input type="text" value=username class="error"}}
							{{else}}
								{{input type="text" value=username}}
							{{/if}}

							{{#if requestMessages.error.username}}
								<span class="message error">{{requestMessages.error.username}}</span>
							{{/if}}
						</div>
						<div class="field-container">
							<label for="password">{{t forms.login.password}}</label>
							{{#if requestMessages.error.password}}
								{{input type="password" value=password class="error"}}
							{{else}}
								{{input type="password" value=password}}
							{{/if}}

							{{#if requestMessages.error.password}}
								<span class="message error">{{requestMessages.error.password}}</span>
							{{/if}}
						</div>
						<div class="field-container">
							<p><button type="submit" class="expand" {{action 'doLogin'}}>{{t forms.login.login_button}}</button></p>
						</div>
						<a href="" {{action "doForgotPassword"}}>{{t forms.login.forgot_password}}</a>
						<div class="forgot-password-notification">{{notificationForgotPassword}}</div>
					</fieldset>
				</form>
			</div>
		</div>
	</section>
</script>

<script type="text/x-handlebars" id="settings">
	<section class="deck">
		<div class="row">
			<div class="medium-6 large-5 medium-centered columns">
				<h3 class="text-center">{{t sections.settings}}</h3>
				<form {{action 'changePassword' on="submit"}}>
					<fieldset class="wrap-set">
						<legend>{{t forms.settings.change_password_header}}</legend>
							<div class="field-container">
								<label for="password">{{t forms.settings.current_password}}</label>
									{{#if requestMessages.error.current_password}}
										{{input type="password" value=current_password class="error"}}
									{{else}}
										{{input type="password" value=current_password}}
									{{/if}}

									{{#if requestMessages.error.current_password}}
										<span class="message error">{{requestMessages.error.current_password}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<label for="password">{{t forms.settings.new_password}}</label>
									{{#if requestMessages.error.new_password}}
										{{input type="password" value=new_password class="error"}}
									{{else}}
										{{input type="password" value=new_password}}
									{{/if}}

									{{#if requestMessages.error.new_password}}
										<span class="message error">{{requestMessages.error.new_password}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<label for="password">{{t forms.settings.new_password2}}</label>
									{{#if requestMessages.error.new_password2}}
										{{input type="password" value=new_password2 class="error"}}
									{{else}}
										{{input type="password" value=new_password2}}
									{{/if}}

									{{#if requestMessages.error.new_password2}}
										<span class="message error">{{requestMessages.error.new_password2}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<p><button type="submit" class="expand" {{action 'changePassword'}}>{{t forms.settings.change_password_button}}</button></p>
							</div>
					</fieldset>
				</form>
			</div>
		</div>
	</section>
</script>

<script type="text/x-handlebars" id="app">
	<style>
		.ember-view{
			height:100%;
		}
	</style>
	<div style="height: 94% !important;">
		<iframe id="app_frame" width="100%" height="100%" {{bindAttr src="app_url"}} frameBorder="0"></iframe>
	</div>
</script>

<script type="text/x-handlebars" id="components/modal-dialog">
	<div class="overlay" {{action "close"}}>
	</div>
	{{#if small}}
		<div class="modal-small">
	{{else}}
		<div class="modal">
	{{/if}}
		{{yield}}
	</div>
</script>

<script type="text/x-handlebars" id="twoFactorVerification">
	{{#modal-dialog action="close"}}
		<div class="row modal-filler">
			<legend>{{t sections.login_two_factor}}</legend>
		</div>
		<div class="row modal-content">
				<div class="large-12 columns" style="padding-top:50px; padding-right: 0px;">
					{{t forms.verification.verify_msg}}
				</div>
				<div class="large-12 columns" style="padding-bottom:50px; padding-top: 40px;">
					<form {{action 'verifyFactor' on="submit"}}>
						<div class="field-container">
							<div class="row">
								<div class="small-7 columns">
									<label for="right-label" class="right">{{t forms.verification.verify_code}}</label>
								</div>
								<div class="small-5 columns">
									{{#if requestMessages.error.verifyCode}}
										{{ input type="text" value=verifyCode class="error" }}
									{{else}}
										{{ input type="text" value=verifyCode }}
									{{/if}}

									{{#if requestMessages.error.verifyCode}}
										<span class="message error">{{requestMessages.error.verifyCode}}</span>
									{{/if}}
								</div>
							</div>
						</div>
						<div class="field-container">
							<div class="row">
								<div class="large-7 medium-5 hide-for-small columns">
									&nbsp;
								</div>
								<div class="large-2 medium-2 small-6 columns">
										<button type="submit" class="alert expand" {{action 'close'}}>{{t forms.verification.cancel_button}}</button>
								</div>
								<div class="large-1 medium-1 hide-for-small columns">
									&nbsp;
								</div>
								<div class="large-2 medium-2 small-6 columns">
										<button type="submit" class="secondary expand" {{action 'verifyFactor'}}>{{t forms.verification.verify_submit}}</button>
								</div>
							</div>
						</div>
					</form>
				</div>
		</div>
		<div class="row modal-filler">
			&nbsp;
		</div>
	{{/modal-dialog}}
</script>


<script type="text/x-handlebars" id="profile">

	<section class="deck">
		<div class="row large-4">
			<form {{action 'doEditProfile' on="submit"}}>
			<fieldset class="wrap-set">
				<legend>{{t sections.profile}}</legend>
					<div class="row">
						<div class="large-4 columns no-padd">
							<label>{{t forms.profile.username}}
								<div><span class="permanent-input">{{name}}</span></div>
							</label>
						</div>
						<div class="large-6 columns no-padd">
							<button class="small right" {{action openChangePassword}} >
								{{t forms.account.change_password}}
							</button>
						</div>
					</div>
					<div class="row">
						<label>{{t forms.profile.first_name}}
						{{#if requestMessages.error.firstName}}
							{{input type="text" value=firstName class="error"}}
							<span class="message error">{{requestMessages.error.firstName}}</span>
						{{else}}
							{{input type="text" value=firstName}}
						{{/if}}
						</label>
					</div>
					<div class="row">
						<label>{{t forms.profile.last_name}}
						{{#if requestMessages.error.lastName}}
							{{input type="text" value=lastName class="error"}}
							<span class="message error">{{requestMessages.error.lastName}}</span>
						{{else}}
							{{input type="text" value=lastName}}
						{{/if}}
						</label>
					</div>
					<div class="row">
						<label>
							{{t forms.profile.recovery_email}}
							{{#if emailVerified}}
								<span class="icon-check success-check"></span>
							{{/if}}
							{{#if requestMessages.error.email}}
								{{input type="text" value=email class="error"}}
								<span class="message error">{{requestMessages.error.email}}</span>
							{{else}}
								{{input type="text" value=email}}
							{{/if}}
						</label>
					</div>
					<div class="row">
						<label>{{t forms.profile.mobile_phone}}
						{{#if requestMessages.error.mobilePhone}}
							{{input type="text" value=mobilePhone class="error"}}
							<span class="message error">{{requestMessages.error.mobilePhone}}</span>
						{{else}}
							{{input type="text" value=mobilePhone}}
						{{/if}}
						</label>
					</div>
					<div class="row">
						<label>{{t forms.account.two_factor_auth}}
							<div class="switch">
									{{input type="checkbox" id="two_factor_auth_checkbox" checked=twoFactor}}
									<label for="two_factor_auth_checkbox"></label>
							</div>
						</label>
					</div>
					<div class="row right">
						<div class="large-12 columns large-right no-padding">
							<button type="submit" class="small right left-margin-small">
								{{t forms.profile.commit_changes}}
							</button>
							<button type="submit" class="small right left-margin-small" {{action 'doReset'}}>
								{{t forms.profile.cancel}}
							</button>
						</div>
					</div>
			</fieldset>
		</div>
	</section>
	{{outlet change_password}}
</script>

<script type="text/x-handlebars" id="change_password_modal">
	{{#modal-dialog small=true}}
		<div class="row modal-filler">
			<legend>{{name}}: {{t forms.account.change_password}}</legend>
		</div>
		<div class="row modal-content">
				<div class="large-12 columns" style="padding-bottom:50px; padding-top: 40px;">
					<form {{action 'doChangePassword' on="submit"}}>
						<div class="field-container">
							<label>{{t forms.account.old_password}}
								<div>
									{{#if requestMessages.error.oldPassword}}
										{{input type="password" value=oldPassword class="error"}}
										<span class="message error">{{requestMessages.error.oldPassword}}</span>
									{{else}}
										{{input type="password" value=oldPassword}}
									{{/if}}
								</div>
							</label>
						</div>
						<div class="field-container">
							<label>{{t forms.account.new_password}}
								<div>
									{{#if requestMessages.error.newPassword}}
										{{input type="password" value=newPassword class="error"}}
										<span class="message error">{{requestMessages.error.newPassword}}</span>
									{{else}}
										{{input type="password" value=newPassword}}
									{{/if}}
								</div>
							</label>
						</div>
						<div class="field-container">
							<div class="row">
								<div class="large-5 columns">
										<button type="submit" class="alert expand" {{action 'doCloseModal'}}>{{t forms.verification.cancel_button}}</button>
								</div>
								<div class="large-6 columns">
									<button type="submit" class="secondary expand" {{action 'doChangePassword'}}>{{t forms.account.change_password}}</button>
								</div>
							</div>
						</div>
					</form>
				</div>
		</div>
		<div class="row modal-filler">
			&nbsp;
		</div>
	{{/modal-dialog}}
</script>

<script type="text/x-handlebars" id="resetPassword">
	<section class="deck">
		<div class="row">
			<div class="medium-6 large-5 small-12 medium-centered columns">
				<form {{action 'doResetPassword' on="submit"}}>
					<fieldset class="wrap-set small-12">
						<legend>{{t sections.reset_password}}</legend>
						<div class="field-container">
							<label for="password">{{t forms.login.password}}</label>
							{{#if requestMessages.error.password}}
								{{input type="password" value=password class="error"}}
							{{else}}
								{{input type="password" value=password}}
							{{/if}}

							{{#if requestMessages.error.password}}
								<span class="message error">{{requestMessages.error.password}}</span>
							{{/if}}
						</div>
						<div class="field-container">
							<label for="password_confirm">{{t forms.login.password2}}</label>
							{{#if requestMessages.error.passwordConfirm}}
								{{input type="password" value=passwordConfirm class="error"}}
							{{else}}
								{{input type="password" value=passwordConfirm}}
							{{/if}}

							{{#if requestMessages.error.passwordConfirm}}
								<span class="message error">{{requestMessages.error.passwordConfirm}}</span>
							{{/if}}
						</div>
						<div class="field-container">
							<p><button type="submit" class="expand">{{t forms.reset_password.submit}}</button></p>
						</div>
						<div class="forgot-password-notification">{{resetPasswordSuccessful}}</div>
					</fieldset>
				</form>
			</div>
		</div>
	</section>
</script>
</body>
</html>
