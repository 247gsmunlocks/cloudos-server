<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CloudOS</title>
    <link rel="stylesheet" href="css/app.css">
    <script src="js/app.js"></script>
    <script src="js/apps/cloudos-app.js"></script>
	<script src="localize?js/local/strings.js"></script>
</head>
<body>

<script type="text/x-handlebars">
    <section class="app-bar">
	<nav class="top-bar" data-top-bar>
			<ul class="title-area">
				<li class="name">
					<h1>
						<a class="brand" href="#">{{t app.title}} <!--active_account={{active_account.name}}--></a>
					</h1>
				</li>
				<li class="toggle-topbar menu-icon">
					<a href="#">
						<span></span>
					</a>
				</li>
			</ul>
			<section class="top-bar-section">
            	<!--<ul>
                	{{#if cloudos_account.admin}}
                    	<li><a href="/admin.html">{{t sections.admin}}</a></li>
                	{{/if}}
				</ul>-->
				<ul class="nav-apps">
                	{{#if cloudos_account}}
                    	{{#each cloudos_account.availableApps}}
                        	<li>
                        		<a {{action 'select_app' this.name}}>
									<span {{bind-attr class=this.icon_name}} data-tooltip aria-haspopup="true" class="has-tip" title="{{app-name name}}"></span>
									<span class="show-for-xxlarge-up">{{app-name name}}</span>
								</a>
							</li>
                    	{{/each}}
                	{{/if}}
				</ul>

			</section>
			{{#if cloudos_account}}
			<section class="top-bar-section show-for-medium-up right">
				<ul>
					<li><a href="#" data-dropdown="help-submenu" data-options="align:left"><span class="icon-question-circle"></span> <span class="show-for-xxlarge-up">Help</span></a></li>
					<li><a href="#" data-dropdown="settings-submenu" data-options="align:left"><span class="icon-gear"></span> <span class="show-for-xxlarge-up">Settings</span></a></li>
					<li><a href="#" data-dropdown="user-submenu" data-options="align:left"><span class="icon-user"></span> <span class="show-for-xxlarge-up">User</span></a></li>
				</ul>
			</section>
			<section class="top-bar-section show-for-medium-up right">
				<div class="row">
					<div class="large-12 columns">
						<div class="row collapse">
							<div class="small-10 columns">
								<input type="text" placeholder="">
							</div>
							<div class="small-2 columns">
								<a href="#" class="button tiny" style="top:0px;"><span class="icon-search"></span> <span class="show-for-xxlarge-up">Search</span></a>
							</div>
						</div>
					</div>
				</div>
			</section>
			{{/if}}
    </nav>
	</section>
	<ul id="help-submenu" class="f-dropdown update-dropdown" data-dropdown-content>
		<li><a href="#">Online Help</a></li>
		<li><a href="#">What's new</a></li>
		<li><a href="#">Service status</a></li>
		<li class="divider"></li>
		<li><a href="#">Open support ticket</a></li>
	</ul>
	<ul id="user-submenu" class="f-dropdown update-dropdown" data-dropdown-content>
		<li><a href="#">Profile</a></li>
		<li>{{#link-to 'settings'}}{{t menu.settings}}{{/link-to}}</li>
		<li class="divider"></li>
		<li>{{#link-to 'logout'}}{{t sections.logout}}{{/link-to}}</li>
	</ul>
	<ul id="settings-submenu" class="f-dropdown update-dropdown" data-dropdown-content>
		<li><label>CLOUDSTEAD SETTINGS</label></li>
		{{#if cloudos_account.admin}}
			<li><a href="/admin.html#/accounts">{{t menu.accounts}}</a></li>
			<li><a href="/admin.html#/email">{{t menu.emaildom}}</a></li>
			<li><a href="/admin.html#/security">{{t menu.securitycert}}</a></li>
		{{/if}}
		<li><a href="#">{{t menu.defaultapps}}</a></li>
		<li><a href="/admin.html#/appstore">{{t menu.appstore}}</a></li>
		<li class="divider"></li>
		<li><label>OTHER APPLICATIONS</label></li>
		<li><a href="#">Confluence Administration</a></li>
		<li><a href="#">Jira Administration</a></li>
		<li><a href="#">Phabricator Admninistration</a></li>
	</ul>

    {{outlet}}
		{{outlet modal}}
</script>

<script type="text/x-handlebars" id="login">
    <section class="deck">
        <div class="row">
            <div class="medium-6 large-5 medium-centered columns">
				<form {{action 'doLogin' on="submit"}}>
			<fieldset class="wrap-set">
				<legend>{{t sections.login}}</legend>
				<div class="field-container">
					<label for="text">{{t forms.login.username}}</label>
					{{#if requestMessages.error.username}}
						{{input type="text" value=username class="error"}}
					{{else}}
						{{input type="text" value=username}}
					{{/if}}

					{{#if requestMessages.error.username}}
						<span class="message error">{{requestMessages.error.username}}</span>
					{{/if}}
				</div>
				<div class="field-container">
					<label for="password">{{t forms.login.password}}</label>
					{{#if requestMessages.error.password}}
						{{input type="password" value=password class="error"}}
					{{else}}
						{{input type="password" value=password}}
					{{/if}}

					{{#if requestMessages.error.password}}
						<span class="message error">{{requestMessages.error.password}}</span>
					{{/if}}
				</div>
				<div class="field-container">
					<p><button type="submit" class="expand" {{action 'doLogin'}}>{{t forms.login.login_button}}</button></p>
				</div>
			</fieldset>
				</form>
            </div>
        </div>
    </section>
</script>

<script type="text/x-handlebars" id="settings">
    <section class="deck">
        <div class="row">
            <div class="medium-6 large-5 medium-centered columns">
				<h3 class="text-center">{{t sections.settings}}</h3>
				<form {{action 'changePassword' on="submit"}}>
					<fieldset class="wrap-set">
						<legend>{{t forms.settings.change_password_header}}</legend>
							<div class="field-container">
								<label for="password">{{t forms.settings.current_password}}</label>
									{{#if requestMessages.error.current_password}}
										{{input type="password" value=current_password class="error"}}
									{{else}}
										{{input type="password" value=current_password}}
									{{/if}}

									{{#if requestMessages.error.current_password}}
										<span class="message error">{{requestMessages.error.current_password}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<label for="password">{{t forms.settings.new_password}}</label>
									{{#if requestMessages.error.new_password}}
										{{input type="password" value=new_password class="error"}}
									{{else}}
										{{input type="password" value=new_password}}
									{{/if}}

									{{#if requestMessages.error.new_password}}
										<span class="message error">{{requestMessages.error.new_password}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<label for="password">{{t forms.settings.new_password2}}</label>
									{{#if requestMessages.error.new_password2}}
										{{input type="password" value=new_password2 class="error"}}
									{{else}}
										{{input type="password" value=new_password2}}
									{{/if}}

									{{#if requestMessages.error.new_password2}}
										<span class="message error">{{requestMessages.error.new_password2}}</span>
									{{/if}}
							</div>
							<div class="field-container">
								<p><button type="submit" class="expand" {{action 'changePassword'}}>{{t forms.settings.change_password_button}}</button></p>
							</div>
					</fieldset>
				</form>
            </div>
        </div>
    </section>
</script>

<script type="text/x-handlebars" id="app">
	<style>
		.ember-view{
			height:100%;
		}
	</style>
    <div style="height: 94% !important;">
        <iframe id="app_frame" width="100%" height="100%" {{bindAttr src="app_url"}} frameBorder="0"></iframe>
    </div>
</script>

<script type="text/x-handlebars" id="components/modal-dialog">
	<div class="overlay" {{action "close"}}>
	</div>
	<div class="modal">
		{{yield}}
	</div>
</script>

<script type="text/x-handlebars" id="twoFactorVerification">
	{{#modal-dialog action="close"}}
		<div class="row modal-filler">
			<legend>{{t sections.login_two_factor}}</legend>
		</div>
		<div class="row modal-content">
				<div class="large-12 columns" style="padding-top:50px; padding-right: 0px;">
					{{t forms.verification.verify_msg}}
				</div>
				<div class="large-12 columns" style="padding-bottom:50px; padding-top: 40px;">
					<form {{action 'verifyFactor' on="submit"}}>
						<div class="field-container">
							<div class="row">
								<div class="small-7 columns">
									<label for="right-label" class="right">{{t forms.verification.verify_code}}</label>
								</div>
								<div class="small-5 columns">
									{{#if requestMessages.error.verifyCode}}
										{{ input type="text" value=verifyCode class="error" }}
									{{else}}
										{{ input type="text" value=verifyCode }}
									{{/if}}

									{{#if requestMessages.error.verifyCode}}
										<span class="message error">{{requestMessages.error.verifyCode}}</span>
									{{/if}}
								</div>
							</div>
						</div>
						<div class="field-container">
							<div class="row">
								<div class="large-7 medium-5 hide-for-small columns">
									&nbsp;
								</div>
								<div class="large-2 medium-2 small-6 columns">
										<button type="submit" class="alert expand" {{action 'close'}}>{{t forms.verification.cancel_button}}</button>
								</div>
								<div class="large-1 medium-1 hide-for-small columns">
									&nbsp;
								</div>
								<div class="large-2 medium-2 small-6 columns">
										<button type="submit" class="secondary expand" {{action 'verifyFactor'}}>{{t forms.verification.verify_submit}}</button>
								</div>
							</div>
						</div>
					</form>
				</div>
		</div>
		<div class="row modal-filler">
			&nbsp;
		</div>
	{{/modal-dialog}}
</script>

</body>
</html>
